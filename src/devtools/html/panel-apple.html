<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta content="width=device-width, initial-scale=1.0" name="viewport" />
        <title>MicroTSM Devtools Panel</title>
        <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
        <link href="https://fonts.googleapis.com" rel="preconnect" />
        <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
        <link
            href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap"
            rel="stylesheet"
        />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet" />
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet" />
        <style type="text/tailwindcss">
            :root {
                --background-light: #ffffff;
                --background-medium: #f8f8f8;
                --background-dark: #1c1c1e;
                --text-primary-light: #1d1d1f;
                --text-secondary-light: #6e6e73;
                --text-primary-dark: #f5f5f7;
                --text-secondary-dark: #a1a1a6;
                --accent-blue: #007aff;
                --accent-green: #34c759;
                --accent-yellow: #ffcc00;
                --accent-red: #ff3b30;
                --divider-light: #e5e5ea;
                --divider-dark: #3a3a3c;
                --panel-shadow: 0px 8px 24px rgba(0, 0, 0, 0.1), 0px 1px 4px rgba(0, 0, 0, 0.05);
                --control-background-light: #f2f2f7;
                --control-background-dark: #2c2c2e;
            }

            body {
                font-family:
                    'Inter',
                    -apple-system,
                    BlinkMacSystemFont,
                    'SF Pro Text',
                    'Segoe UI',
                    Roboto,
                    Helvetica,
                    Arial,
                    sans-serif,
                    'Apple Color Emoji',
                    'Segoe UI Emoji',
                    'Segoe UI Symbol';
                background-color: var(--background-light);
                color: var(--text-primary-light);
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .table-container {
                max-height: 300px;
                overflow-y: auto;
                border: 1px solid var(--divider-light);
                border-radius: 8px;
            }

            .tab-active {
                background-color: var(--accent-blue) !important;
                color: var(--background-light) !important;
                font-weight: 500;
            }

            .tab-active .material-icons-outlined,
            .tab-active .material-icons-round {
                color: var(--background-light) !important;
            }

            .devtools-panel-compact aside {
                width: 4.5rem;
            }

            .devtools-panel-compact aside nav button {
                justify-content: center;
                padding-left: 0.75rem;
                padding-right: 0.75rem;
                height: 3rem;
                border-radius: 8px;
            }

            .devtools-panel-compact aside nav button .tab-label {
                display: none;
            }

            .devtools-panel-fullscreen aside {
                width: 240px;
                padding: 0.75rem;
                background-color: var(--background-medium);
            }

            .devtools-panel-fullscreen aside nav button {
                justify-content: flex-start;
                height: 2.75rem;
                padding: 0 0.75rem;
                border-radius: 8px;
            }

            .devtools-panel-fullscreen aside nav button .tab-label {
                display: inline;
                margin-left: 0.75rem;
            }

            .icon-button {
                color: var(--text-secondary-light);
                background-color: transparent;
                padding: 0.375rem;
                border-radius: 9999px;
                transition:
                    background-color 0.15s ease-in-out,
                    color 0.15s ease-in-out;
            }

            .icon-button:hover {
                background-color: rgba(0, 0, 0, 0.05);
                color: var(--text-primary-light);
            }

            .icon-button:active {
                background-color: rgba(0, 0, 0, 0.1);
            }

            .status-badge {
                display: inline-flex;
                align-items: center;
                padding: 0.25rem 0.625rem;
                border-radius: 9999px;
                font-size: 0.75rem;
                font-weight: 500;
            }

            .status-badge-green {
                background-color: #e6f6e9;
                color: var(--accent-green);
            }

            .status-badge-yellow {
                background-color: #fff8e1;
                color: #f59e0b;
            }

            .status-badge-red {
                background-color: #ffebee;
                color: var(--accent-red);
            }

            .status-badge-gray {
                background-color: var(--control-background-light);
                color: var(--text-secondary-light);
            }

            .status-badge .material-icons-outlined,
            .status-badge .material-icons-round {
                font-size: 1rem;
                margin-right: 0.25rem;
            }

            input[type='text'],
            input[type='search'] {
                background-color: var(--control-background-light);
                border: 1px solid var(--divider-light);
                border-radius: 8px;
                padding: 0.5rem 0.75rem;
                font-size: 0.875rem;
                color: var(--text-primary-light);
                transition:
                    border-color 0.15s ease-in-out,
                    box-shadow 0.15s ease-in-out;
            }

            input[type='text']:focus,
            input[type='search']:focus {
                border-color: var(--accent-blue);
                box-shadow: 0 0 0 2px rgba(0, 122, 255, 0.2);
                outline: none;
            }

            .search-input-container {
                position: relative;
            }

            .search-input-container .material-icons-outlined {
                position: absolute;
                left: 0.75rem;
                top: 50%;
                transform: translateY(-50%);
                color: var(--text-secondary-light);
                font-size: 1.25rem;
            }

            .search-input-container input[type='search'] {
                padding-left: 2.5rem;
            }

            table {
                font-size: 0.875rem;
            }

            th {
                background-color: var(--background-medium);
                color: var(--text-secondary-light);
                font-weight: 500;
                text-transform: none;
                letter-spacing: normal;
                padding: 0.625rem 0.75rem;
                border-bottom: 1px solid var(--divider-light);
            }

            td {
                color: var(--text-primary-light);
                padding: 0.625rem 0.75rem;
                border-bottom: 1px solid var(--divider-light);
            }

            tbody tr:last-child td {
                border-bottom: none;
            }

            .module-override-url {
                font-size: 0.8125rem;
            }

            .dialog-overlay {
                background-color: rgba(0, 0, 0, 0.4);
            }

            .dialog-content {
                background-color: var(--background-light);
                border-radius: 12px;
                box-shadow: 0px 10px 30px rgba(0, 0, 0, 0.15);
                padding: 1.5rem;
            }

            .dialog-title {
                font-size: 1.125rem;
                font-weight: 600;
                color: var(--text-primary-light);
            }

            .dialog-message {
                font-size: 0.875rem;
                color: var(--text-secondary-light);
                margin-top: 0.5rem;
            }

            .dialog-checkbox-label {
                font-size: 0.875rem;
                color: var(--text-primary-light);
            }

            input[type='checkbox'] {
                border-radius: 4px;
                border-color: var(--divider-light);
                color: var(--accent-blue);
            }

            input[type='checkbox']:focus {
                ring: var(--accent-blue);
                ring-offset-color: var(--background-light);
            }

            .button-primary {
                background-color: var(--accent-blue);
                color: white;
                font-weight: 500;
                padding: 0.5rem 1rem;
                border-radius: 8px;
                transition: background-color 0.15s ease-in-out;
            }

            .button-primary:hover {
                background-color: #006adc;
            }

            .button-secondary {
                background-color: var(--control-background-light);
                color: var(--accent-blue);
                font-weight: 500;
                padding: 0.5rem 1rem;
                border-radius: 8px;
                border: 1px solid var(--divider-light);
                transition: background-color 0.15s ease-in-out;
            }

            .button-secondary:hover {
                background-color: #e9e9ed;
            }

            .header {
                background-color: var(--background-medium);
                color: var(--text-primary-light);
                border-bottom: 1px solid var(--divider-light);
            }

            .footer {
                background-color: var(--background-medium);
                color: var(--text-secondary-light);
                border-top: 1px solid var(--divider-light);
            }
        </style>
    </head>
    <body class="bg-transparent">
        <div
            class="fixed bottom-4 right-4 w-[850px] max-h-[calc(100vh-32px)] flex flex-col bg-[var(--background-light)] rounded-xl shadow-[var(--panel-shadow)] overflow-hidden transition-all duration-300 ease-in-out devtools-panel-compact"
            id="devtools-panel"
        >
            <header class="header p-3 flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <span class="material-icons-outlined text-xl text-[var(--accent-blue)]">build_circle</span>
                    <h1 class="text-base font-semibold text-[var(--text-primary-light)]">MicroTSM DevTools</h1>
                </div>
                <div class="flex items-center gap-1">
                    <button class="icon-button" id="toggle-fullscreen-btn" title="Toggle Fullscreen">
                        <span class="material-icons-outlined text-xl">fullscreen</span>
                    </button>
                    <button class="icon-button" id="close-panel-btn" title="Close Panel">
                        <span class="material-icons-round text-xl">close</span>
                    </button>
                </div>
            </header>
            <div class="flex flex-grow overflow-hidden">
                <aside
                    class="bg-[var(--background-medium)] border-r border-[var(--divider-light)] p-1 transition-all duration-300 ease-in-out"
                >
                    <nav class="space-y-1">
                        <button
                            class="w-full flex items-center gap-3 px-3 py-2 text-left text-sm font-medium text-[var(--text-secondary-light)] hover:bg-gray-100 rounded-lg border-l-4 border-transparent transition-colors duration-150 tab-active"
                            data-tab="import-map-overrides"
                        >
                            <span class="material-icons-outlined text-lg">tune</span>
                            <span class="tab-label">Overrides</span>
                        </button>
                        <button
                            class="w-full flex items-center gap-3 px-3 py-2 text-left text-sm font-medium text-[var(--text-secondary-light)] hover:bg-gray-100 rounded-lg border-l-4 border-transparent transition-colors duration-150"
                            data-tab="module-loader-log"
                        >
                            <span class="material-icons-outlined text-lg">description</span>
                            <span class="tab-label">Loader Log</span>
                        </button>
                        <button
                            class="w-full flex items-center gap-3 px-3 py-2 text-left text-sm font-medium text-[var(--text-secondary-light)] hover:bg-gray-100 rounded-lg border-l-4 border-transparent transition-colors duration-150"
                            data-tab="performance-metrics"
                        >
                            <span class="material-icons-outlined text-lg">speed</span>
                            <span class="tab-label">Performance</span>
                        </button>
                        <button
                            class="w-full flex items-center gap-3 px-3 py-2 text-left text-sm font-medium text-[var(--text-secondary-light)] hover:bg-gray-100 rounded-lg border-l-4 border-transparent transition-colors duration-150"
                            data-tab="contextual-information"
                        >
                            <span class="material-icons-outlined text-lg">info</span>
                            <span class="tab-label">Context</span>
                        </button>
                    </nav>
                </aside>
                <main class="flex-grow p-4 overflow-y-auto bg-[var(--background-light)]">
                    <div class="tab-pane active" id="tab-content-import-map-overrides">
                        <section class="mb-6">
                            <div class="bg-[var(--background-light)] p-0">
                                <div class="flex justify-between items-center mb-4">
                                    <h2 class="text-xl font-semibold text-[var(--text-primary-light)]">
                                        Import Map Overrides
                                    </h2>
                                    <span class="status-badge status-badge-green" id="persisted-status">
                                        <span class="material-icons-round">save</span> Overrides Persisted
                                    </span>
                                </div>
                                <div class="search-input-container mb-4">
                                    <span class="material-icons-outlined">search</span>
                                    <input
                                        class="w-full"
                                        id="search-modules-input"
                                        placeholder="Search modules..."
                                        type="search"
                                    />
                                </div>
                                <div class="table-container">
                                    <table class="min-w-full divide-y divide-[var(--divider-light)]">
                                        <thead class="sticky top-0 z-10">
                                            <tr>
                                                <th scope="col">Module Name</th>
                                                <th scope="col">Original URL</th>
                                                <th scope="col">Override URL</th>
                                                <th scope="col">Load Time</th>
                                                <th scope="col">Status</th>
                                                <th scope="col">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody
                                            class="bg-white divide-y divide-[var(--divider-light)]"
                                            id="modules-tbody"
                                        >
                                            <tr>
                                                <td class="font-medium">@microtsm/core</td>
                                                <td
                                                    class="text-xs max-w-[100px] truncate text-[var(--text-secondary-light)]"
                                                    title="https://cdn.jsdelivr.net/npm/@microtsm/core@1.2.3/dist/index.js"
                                                >
                                                    https://cdn.jsdelivr.net/npm/@microtsm/core@1.2.3/dist/index.js
                                                </td>
                                                <td>
                                                    <input
                                                        class="module-override-url w-full"
                                                        placeholder="Enter override URL"
                                                        type="text"
                                                        value="http://localhost:8080/core.js"
                                                    />
                                                </td>
                                                <td class="text-[var(--text-secondary-light)]">120ms</td>
                                                <td>
                                                    <span class="status-badge status-badge-green">
                                                        <span class="material-icons-round">check_circle</span> Loaded
                                                    </span>
                                                </td>
                                                <td class="space-x-2">
                                                    <button
                                                        class="icon-button text-[var(--accent-blue)] hover:bg-blue-50"
                                                        title="Save Override"
                                                    >
                                                        <span class="material-icons-outlined text-lg">save</span>
                                                    </button>
                                                    <button
                                                        class="icon-button text-[var(--text-secondary-light)] hover:bg-gray-100"
                                                        title="Reset to Default"
                                                    >
                                                        <span class="material-icons-outlined text-lg">undo</span>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="font-medium">@microtsm/utils</td>
                                                <td
                                                    class="text-xs max-w-[100px] truncate text-[var(--text-secondary-light)]"
                                                    title="https://cdn.jsdelivr.net/npm/@microtsm/utils@0.5.1/dist/index.js"
                                                >
                                                    https://cdn.jsdelivr.net/npm/@microtsm/utils@0.5.1/dist/index.js
                                                </td>
                                                <td>
                                                    <input
                                                        class="module-override-url w-full"
                                                        placeholder="Enter override URL"
                                                        type="text"
                                                    />
                                                </td>
                                                <td class="text-[var(--text-secondary-light)]">-</td>
                                                <td>
                                                    <span class="status-badge status-badge-yellow">
                                                        <span class="material-icons-round">hourglass_empty</span>
                                                        Pending
                                                    </span>
                                                </td>
                                                <td class="space-x-2">
                                                    <button
                                                        class="icon-button text-[var(--accent-blue)] hover:bg-blue-50"
                                                        title="Save Override"
                                                    >
                                                        <span class="material-icons-outlined text-lg">save</span>
                                                    </button>
                                                    <button
                                                        class="icon-button text-[var(--text-secondary-light)] hover:bg-gray-100"
                                                        title="Reset to Default"
                                                    >
                                                        <span class="material-icons-outlined text-lg">undo</span>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="font-medium">@microtsm/ui-components</td>
                                                <td
                                                    class="text-xs max-w-[100px] truncate text-[var(--text-secondary-light)]"
                                                    title="https://cdn.jsdelivr.net/npm/@microtsm/ui-components@2.0.0/dist/main.js"
                                                >
                                                    https://cdn.jsdelivr.net/npm/@microtsm/ui-components@2.0.0/dist/main.js
                                                </td>
                                                <td>
                                                    <input
                                                        class="module-override-url w-full"
                                                        placeholder="Enter override URL"
                                                        type="text"
                                                        value="http://localhost:9001/ui.js"
                                                    />
                                                </td>
                                                <td class="text-[var(--text-secondary-light)]">-</td>
                                                <td>
                                                    <span class="status-badge status-badge-red">
                                                        <span class="material-icons-round">error</span> Error
                                                    </span>
                                                </td>
                                                <td class="space-x-2">
                                                    <button
                                                        class="icon-button text-[var(--accent-blue)] hover:bg-blue-50"
                                                        title="Save Override"
                                                    >
                                                        <span class="material-icons-outlined text-lg">save</span>
                                                    </button>
                                                    <button
                                                        class="icon-button text-[var(--text-secondary-light)] hover:bg-gray-100"
                                                        title="Reset to Default"
                                                    >
                                                        <span class="material-icons-outlined text-lg">undo</span>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="font-medium">@another/module</td>
                                                <td
                                                    class="text-xs max-w-[100px] truncate text-[var(--text-secondary-light)]"
                                                    title="https://cdn.jsdelivr.net/npm/@another/module@1.0.0/index.js"
                                                >
                                                    https://cdn.jsdelivr.net/npm/@another/module@1.0.0/index.js
                                                </td>
                                                <td>
                                                    <input
                                                        class="module-override-url w-full"
                                                        placeholder="Enter override URL"
                                                        type="text"
                                                    />
                                                </td>
                                                <td class="text-[var(--text-secondary-light)]">80ms</td>
                                                <td>
                                                    <span class="status-badge status-badge-green">
                                                        <span class="material-icons-round">check_circle</span> Loaded
                                                    </span>
                                                </td>
                                                <td class="space-x-2">
                                                    <button
                                                        class="icon-button text-[var(--accent-blue)] hover:bg-blue-50"
                                                        title="Save Override"
                                                    >
                                                        <span class="material-icons-outlined text-lg">save</span>
                                                    </button>
                                                    <button
                                                        class="icon-button text-[var(--text-secondary-light)] hover:bg-gray-100"
                                                        title="Reset to Default"
                                                    >
                                                        <span class="material-icons-outlined text-lg">undo</span>
                                                    </button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td class="font-medium">@yet-another/lib</td>
                                                <td
                                                    class="text-xs max-w-[100px] truncate text-[var(--text-secondary-light)]"
                                                    title="https://cdn.jsdelivr.net/npm/@yet-another/lib@3.2.1/main.js"
                                                >
                                                    https://cdn.jsdelivr.net/npm/@yet-another/lib@3.2.1/main.js
                                                </td>
                                                <td>
                                                    <input
                                                        class="module-override-url w-full"
                                                        placeholder="Enter override URL"
                                                        type="text"
                                                    />
                                                </td>
                                                <td class="text-[var(--text-secondary-light)]">-</td>
                                                <td>
                                                    <span class="status-badge status-badge-gray">
                                                        <span class="material-icons-round">watch_later</span> Not Loaded
                                                    </span>
                                                </td>
                                                <td class="space-x-2">
                                                    <button
                                                        class="icon-button text-[var(--accent-blue)] hover:bg-blue-50"
                                                        title="Save Override"
                                                    >
                                                        <span class="material-icons-outlined text-lg">save</span>
                                                    </button>
                                                    <button
                                                        class="icon-button text-[var(--text-secondary-light)] hover:bg-gray-100"
                                                        title="Reset to Default"
                                                    >
                                                        <span class="material-icons-outlined text-lg">undo</span>
                                                    </button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </section>
                    </div>
                    <div class="tab-pane hidden" id="tab-content-module-loader-log">
                        <section class="mb-6">
                            <div class="bg-[var(--background-light)] p-0">
                                <h2 class="text-xl font-semibold text-[var(--text-primary-light)] mb-4">
                                    Module Loader Debug Log
                                </h2>
                                <div
                                    class="bg-[#2c2c2e] text-[#f5f5f7] p-4 rounded-lg font-mono text-xs max-h-96 overflow-y-auto leading-relaxed"
                                >
                                    <p><span class="text-[#00a9ff]">[INFO]</span> MicroTSM DevTools activated.</p>
                                    <p>
                                        <span class="text-[#66d9ef]">[LOAD]</span> Module @microtsm/core requested from
                                        <span class="text-[#ffd700]"
                                            >https://cdn.jsdelivr.net/npm/@microtsm/core@1.2.3/dist/index.js</span
                                        >
                                    </p>
                                    <p>
                                        <span class="text-[#66d9ef]">[LOAD]</span> Module @microtsm/core loaded in
                                        <span class="text-[#ae81ff]">120ms</span>.
                                    </p>
                                    <p>
                                        <span class="text-[#66d9ef]">[LOAD]</span> Module @microtsm/utils requested from
                                        <span class="text-[#ffd700]"
                                            >https://cdn.jsdelivr.net/npm/@microtsm/utils@0.5.1/dist/index.js</span
                                        >
                                    </p>
                                    <p>
                                        <span class="text-[#ffcc00]">[WARN]</span> Override for @microtsm/utils:
                                        <span class="text-[#ffd700]">http://localhost:8081/utils.js</span>
                                    </p>
                                    <p>
                                        <span class="text-[#ff6b6b]">[ERROR]</span> Failed to load module
                                        @microtsm/ui-components: NetworkError.
                                        <a class="text-[#00a9ff] underline hover:text-[#007aff]" href="#"
                                            >View stack trace</a
                                        >
                                    </p>
                                </div>
                            </div>
                        </section>
                    </div>
                    <div class="tab-pane hidden" id="tab-content-performance-metrics">
                        <section>
                            <div class="bg-[var(--background-light)] p-0">
                                <h2 class="text-xl font-semibold text-[var(--text-primary-light)] mb-4">
                                    Performance Metrics
                                </h2>
                                <div class="bg-[var(--background-medium)] p-4 rounded-lg space-y-3 text-sm">
                                    <div class="flex justify-between items-center">
                                        <span class="text-[var(--text-secondary-light)]">Total Modules Loaded:</span>
                                        <span class="font-medium text-[var(--text-primary-light)]">1 / 3</span>
                                    </div>
                                    <hr class="border-[var(--divider-light)]" />
                                    <div class="flex justify-between items-center">
                                        <span class="text-[var(--text-secondary-light)]">Overall Load Time:</span>
                                        <span class="font-medium text-[var(--text-primary-light)]">250ms</span>
                                    </div>
                                    <hr class="border-[var(--divider-light)]" />
                                    <div class="flex justify-between items-center">
                                        <span class="text-[var(--text-secondary-light)]">Average Load Time:</span>
                                        <span class="font-medium text-[var(--text-primary-light)]">120ms</span>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                    <div class="tab-pane hidden" id="tab-content-contextual-information">
                        <section>
                            <div class="bg-[var(--background-light)] p-0">
                                <h2 class="text-xl font-semibold text-[var(--text-primary-light)] mb-4">
                                    Contextual Information
                                </h2>
                                <div class="bg-[var(--background-medium)] p-4 rounded-lg space-y-3 text-sm">
                                    <div>
                                        <span class="text-[var(--text-secondary-light)] block mb-1"
                                            >Base URL (import.meta.url):</span
                                        >
                                        <div
                                            class="bg-white p-2.5 rounded-md text-xs text-[var(--text-primary-light)] border border-[var(--divider-light)] truncate"
                                        >
                                            http://localhost:3000/app/
                                        </div>
                                    </div>
                                    <hr class="border-[var(--divider-light)]" />
                                    <div>
                                        <span class="text-[var(--text-secondary-light)] block mb-1"
                                            >Active Local Storage Key:</span
                                        >
                                        <div
                                            class="bg-white p-2.5 rounded-md text-xs text-[var(--text-primary-light)] border border-[var(--divider-light)] truncate"
                                        >
                                            MicroTSM_DEV=1
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </main>
            </div>
            <footer class="footer p-3 text-xs text-center">
                MicroTSM Developer Tools v0.1.0 © 2024. For development use only.
            </footer>
        </div>
        <div class="fixed inset-0 dialog-overlay flex items-center justify-center p-4 z-50 hidden" id="confirm-dialog">
            <div class="dialog-content w-full max-w-md">
                <div class="flex items-start">
                    <div class="flex-shrink-0 text-[var(--accent-blue)]">
                        <span class="material-icons-outlined text-3xl">help_outline</span>
                    </div>
                    <div class="ml-4">
                        <h3 class="dialog-title" id="confirm-dialog-title">Confirm Action</h3>
                        <p class="dialog-message" id="confirm-dialog-message">Are you sure you want to proceed?</p>
                    </div>
                </div>
                <div class="mt-5 flex items-center">
                    <input
                        class="h-4 w-4 text-[var(--accent-blue)] border-[var(--divider-light)] rounded focus:ring-[var(--accent-blue)]"
                        id="dont-show-again"
                        name="dont-show-again"
                        type="checkbox"
                    />
                    <label class="ml-2 block dialog-checkbox-label" for="dont-show-again">Don't show this again</label>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button class="button-secondary" id="confirm-dialog-cancel" type="button">Cancel</button>
                    <button class="button-primary" id="confirm-dialog-confirm" type="button">Confirm</button>
                </div>
            </div>
        </div>
        <script>
            const toggleButton = document.getElementById('toggle-fullscreen-btn');
            const panel = document.getElementById('devtools-panel');
            const iconElement = toggleButton.querySelector('span'); // Changed to span for Material Icons
            const asideElement = panel.querySelector('aside');
            const mainElement = panel.querySelector('main');
            const closeButton = document.getElementById('close-panel-btn');
            const searchInput = document.getElementById('search-modules-input');
            const modulesTbody = document.getElementById('modules-tbody');
            const persistedStatus = document.getElementById('persisted-status');
            const persistedStatusIcon = persistedStatus.querySelector('span'); // For Material Icons
            // Custom Confirm Dialog Elements
            const confirmDialog = document.getElementById('confirm-dialog');
            const confirmDialogTitle = document.getElementById('confirm-dialog-title');
            const confirmDialogMessage = document.getElementById('confirm-dialog-message');
            const confirmDialogCancelBtn = document.getElementById('confirm-dialog-cancel');
            const confirmDialogConfirmBtn = document.getElementById('confirm-dialog-confirm');
            const dontShowAgainCheckbox = document.getElementById('dont-show-again');
            let confirmCallback = null;
            let cancelCallback = null;
            let dialogIdentifier = '';

            function showConfirmDialog(title, message, onConfirm, onCancel, id) {
                dialogIdentifier = id;
                if (localStorage.getItem(`dontShow_${dialogIdentifier}`) === 'true') {
                    onConfirm();
                    return;
                }
                confirmDialogTitle.textContent = title;
                confirmDialogMessage.textContent = message;
                confirmCallback = onConfirm;
                cancelCallback = onCancel;
                dontShowAgainCheckbox.checked = false;
                confirmDialog.classList.remove('hidden');
            }

            confirmDialogConfirmBtn.addEventListener('click', () => {
                if (dontShowAgainCheckbox.checked && dialogIdentifier) {
                    localStorage.setItem(`dontShow_${dialogIdentifier}`, 'true');
                }
                confirmDialog.classList.add('hidden');
                if (confirmCallback) confirmCallback();
            });
            confirmDialogCancelBtn.addEventListener('click', () => {
                confirmDialog.classList.add('hidden');
                if (cancelCallback) cancelCallback();
            });
            toggleButton.addEventListener('click', () => {
                if (panel.classList.contains('devtools-panel-compact')) {
                    panel.classList.remove(
                        'w-[850px]',
                        'max-h-[calc(100vh-32px)]',
                        'fixed',
                        'bottom-4',
                        'right-4',
                        'rounded-xl',
                        'shadow-[var(--panel-shadow)]',
                        'devtools-panel-compact',
                    );
                    panel.classList.add(
                        'w-screen',
                        'h-screen',
                        'fixed',
                        'top-0',
                        'left-0',
                        'rounded-none',
                        'shadow-none',
                        'devtools-panel-fullscreen',
                    );
                    iconElement.textContent = 'fullscreen_exit'; // Material Icon name
                    toggleButton.title = 'Exit Fullscreen';
                } else {
                    panel.classList.remove(
                        'w-screen',
                        'h-screen',
                        'fixed',
                        'top-0',
                        'left-0',
                        'rounded-none',
                        'shadow-none',
                        'devtools-panel-fullscreen',
                    );
                    panel.classList.add(
                        'w-[850px]',
                        'max-h-[calc(100vh-32px)]',
                        'fixed',
                        'bottom-4',
                        'right-4',
                        'rounded-xl',
                        'shadow-[var(--panel-shadow)]',
                        'devtools-panel-compact',
                    );
                    iconElement.textContent = 'fullscreen'; // Material Icon name
                    toggleButton.title = 'Toggle Fullscreen';
                }
            });
            closeButton.addEventListener('click', () => {
                panel.style.display = 'none';
            });
            const tabButtons = document.querySelectorAll('aside nav button');
            const tabPanes = document.querySelectorAll('main .tab-pane');
            tabButtons.forEach((button) => {
                button.addEventListener('click', () => {
                    tabButtons.forEach((btn) => {
                        btn.classList.remove('tab-active');
                        // Reset styles for non-active tabs
                        btn.classList.add(
                            'text-[var(--text-secondary-light)]',
                            'hover:bg-gray-100',
                            'border-transparent',
                        );
                        btn.classList.remove('bg-[var(--accent-blue)]', 'text-[var(--background-light)]');
                    });
                    tabPanes.forEach((pane) => {
                        pane.classList.add('hidden');
                    });
                    button.classList.add('tab-active');
                    // Remove general hover styles when active
                    button.classList.remove(
                        'text-[var(--text-secondary-light)]',
                        'hover:bg-gray-100',
                        'border-transparent',
                    );
                    // Explicitly set active styles (already handled by .tab-active but good for clarity)
                    button.classList.add('bg-[var(--accent-blue)]', 'text-[var(--background-light)]');
                    const tabId = button.dataset.tab;
                    const activePane = document.getElementById(`tab-content-${tabId}`);
                    if (activePane) {
                        activePane.classList.remove('hidden');
                    }
                });
            });
            searchInput.addEventListener('input', (event) => {
                const searchTerm = event.target.value.toLowerCase();
                const rows = modulesTbody.querySelectorAll('tr');
                rows.forEach((row) => {
                    const moduleName = row.querySelector('td:first-child').textContent.toLowerCase();
                    const originalUrl = row.querySelector('td:nth-child(2)').textContent.toLowerCase();
                    if (moduleName.includes(searchTerm) || originalUrl.includes(searchTerm)) {
                        row.style.display = '';
                    } else {
                        row.style.display = 'none';
                    }
                });
            });
            modulesTbody.addEventListener('click', (event) => {
                const target = event.target.closest('button');
                if (!target) return;
                const row = target.closest('tr');
                const moduleName = row.querySelector('td:first-child').textContent;
                const overrideInput = row.querySelector('.module-override-url');
                if (target.querySelector('span').textContent === 'save') {
                    // Check based on Material Icon name
                    const overrideUrl = overrideInput.value;
                    const dialogId = `saveOverride_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                    showConfirmDialog(
                        'Save Override',
                        `Are you sure you want to save the override for ${moduleName} to: ${overrideUrl || '(cleared)'}?`,
                        () => {
                            // onConfirm
                            console.log(`Saving override for ${moduleName}: ${overrideUrl}`);
                            persistedStatus.classList.remove('status-badge-yellow', 'status-badge-red');
                            persistedStatus.classList.add('status-badge-green');
                            persistedStatusIcon.textContent = 'save'; // Material Icon name
                            persistedStatus.childNodes[2].nodeValue = ' Overrides Persisted'; // Update text node
                            const saveIcon = target.querySelector('span');
                            saveIcon.textContent = 'check'; // Material Icon name
                            saveIcon.classList.add('text-[var(--accent-green)]');
                            setTimeout(() => {
                                saveIcon.textContent = 'save'; // Material Icon name
                                saveIcon.classList.remove('text-[var(--accent-green)]');
                            }, 1500);
                        },
                        () => {
                            // onCancel
                            console.log(`Save operation for ${moduleName} cancelled.`);
                        },
                        dialogId,
                    );
                } else if (target.querySelector('span').textContent === 'undo') {
                    // Check based on Material Icon name
                    const dialogId = `resetOverride_${moduleName.replace(/[^a-zA-Z0-9]/g, '_')}`;
                    showConfirmDialog(
                        'Reset Override',
                        `Are you sure you want to reset the override for ${moduleName}? This will clear any custom URL.`,
                        () => {
                            // onConfirm
                            console.log(`Resetting override for ${moduleName}`);
                            overrideInput.value = '';
                            persistedStatus.classList.remove('status-badge-green');
                            persistedStatus.classList.add('status-badge-yellow');
                            persistedStatusIcon.textContent = 'warning'; // Material Icon name
                            persistedStatus.childNodes[2].nodeValue = ' Changes Not Persisted'; // Update text node
                        },
                        () => {
                            // onCancel
                            console.log(`Reset operation for ${moduleName} cancelled.`);
                        },
                        dialogId,
                    );
                }
            });
            modulesTbody.addEventListener('input', (event) => {
                if (event.target.classList.contains('module-override-url')) {
                    persistedStatus.classList.remove('status-badge-green');
                    persistedStatus.classList.add('status-badge-yellow');
                    persistedStatusIcon.textContent = 'warning'; // Material Icon name
                    persistedStatus.childNodes[2].nodeValue = ' Changes Not Persisted'; // Update text node
                }
            });
            // Initial tab setup
            document.querySelector('aside nav button[data-tab="import-map-overrides"]').click();
            console.log('MicroTSM Devtools Panel Initialized - Apple Style');
        </script>
    </body>
</html>
